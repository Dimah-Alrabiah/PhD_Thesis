# Script: 04_load_filter_samples.R
# Purpose: Load and filter integration site result files generated by VSeq
# Author: Dimah Alrabiah
# Description:
#   This script reads IS (integration site) result files from VSeq,
#   removes rows with missing values, and filters for high-confidence IS
#   supported by 4 or more chimeric reads (SequenceCount â‰¥ 4).
#   The output is a cleaned and combined dataframe for downstream analysis.
# Language: R
# Required Package: dplyr

# Load necessary package
library(dplyr)

# Define file paths (update these paths to match your actual file locations)
file_paths <- list(
  Sample1 = "path/to/Sample1_IS_results.csv",
  Sample2 = "path/to/Sample2_IS_results.csv",
  Sample3 = "path/to/Sample3_IS_results.csv"
)

# Load, clean, and filter each sample
filtered_samples <- lapply(file_paths, function(path) {
  df <- read.csv(path)
  df <- df %>% 
    na.omit() %>%                          # Remove rows with missing values
    filter(SequenceCount >= 4)             # Keep only high-confidence IS
  return(df)
})

# Combine all filtered samples into a single dataframe
combined_df <- bind_rows(filtered_samples, .id = "Sample")

# View a summary
summary(combined_df)
